# UAB-medicine-calendar

1. PDF 이미지 추출  
  
&emsp;목적: PDF 문서의 각 페이지를 고해상도 이미지(PNG) 파일로 변환하여 저장합니다.  
&emsp;핵심 내용:   
&emsp;&emsp;PDF 파일을 읽어, 지정된 DPI(예: 300 DPI)로 각 페이지를 이미지로 변환합니다.  
&emsp;&emsp;변환된 이미지는 고정 디렉토리(예: "images")에 "page_1.png", "page_2.png", … 형식으로 저장됩니다.  
  
2. 표 영역 추출 및 좌표 리스트 확보  
  
&emsp;목적: PDF 이미지 또는 변환된 이미지에서 표 영역을 검출하고, 표 내부의 셀 경계를 나타내는 x좌표 리스트와 y좌표 리스트를 확보합니다.  
&emsp;핵심 내용:  
&emsp;&emsp;이미지 전처리(그레이스케일 변환, GaussianBlur 등)를 진행한 후, adaptive thresholding과 Morphological 연산을 통해 표 영역의 선(경계선)을 강조합니다.  
&emsp;&emsp;컨투어 검출 등을 활용하여 표 영역을 추출하며, 이 과정에서 표의 내부 셀 경계에 해당하는 좌표 값들이 x_list와 y_list로 확보됩니다.  
&emsp;&emsp;필요에 따라 첫 번째 페이지에 불규칙한 병합이 있는 경우, 전처리 단계에서 y좌표 리스트의 첫 번째 좌표를 제거하는 방법도 적용할 수 있습니다.  
  
3. 행렬(그리드) 및 병합 셀 구성  
  
&emsp;목적: 확보한 x, y 좌표 리스트를 바탕으로 기본 그리드(행렬)를 구성하고, 각 그리드 셀에 대해 실제 병합된 셀(merged cell) 여부를 판별합니다.  
&emsp;핵심 내용:  
&emsp;&emsp;기본 그리드는 x_list와 y_list의 인접 좌표 쌍을 이용해 각 셀 영역을 정의하며, 전체 그리드의 크기는 (len(y_list)–1) × (len(x_list)–1)입니다.  
&emsp;&emsp;각 셀(현재 셀, 즉 아직 방문되지 않은 셀)부터 시작하여, 오른쪽과 아래쪽의 인접 셀에 대해 경계선 감지(세로 경계선 및 가로 경계선)를 수행합니다.  
&emsp;&emsp;&emsp;우측 병합:  
&emsp;&emsp;&emsp;&emsp;시작 셀의 오른쪽 경계선이 존재하면 병합하지 않고 단일 셀로 간주합니다.  
&emsp;&emsp;&emsp;&emsp;만약 경계선이 없으면, 오른쪽 인접 셀들을 순차적으로 검사하면서 경계선이 처음 등장하는 셀까지를 하나의 병합 영역으로 결정합니다.  
&emsp;&emsp;&emsp;아래쪽 병합:  
&emsp;&emsp;&emsp;&emsp;시작 셀의 아래쪽 경계선이 존재하면 병합하지 않고 단일 셀로 취급합니다.  
&emsp;&emsp;&emsp;&emsp;만약 경계선이 없으면, 아래쪽 인접 행들을 순차적으로 검사하여, 경계선이 처음 발견되는 행까지를 병합 영역으로 결정합니다.  
&emsp;&emsp;병합된 셀은 기본 그리드 상의 좌측 상단 셀에만 병합 정보(병합한 가로 칸 수(x_span), 병합한 세로 칸 수(y_span), 전체 영역 크기 등)를 저장하고, 나머지 해당 영역은 방문 처리하여 건너뛰도록 합니다.  
&emsp;&emsp;최종 결과로, 2차원 셀 행렬(cell_matrix)과 활성 셀 리스트(cells)가 생성되며, 각 활성 셀은 나중에 데이터 처리나 변환에 활용할 수 있는 객체(딕셔너리) 형태로 관리됩니다.  
  
4. 디버그 이미지 생성  
  
&emsp;목적: 생성된 셀 행렬 및 병합 정보가 올바른지 시각적으로 검증하기 위해, 원본 이미지 위에 각 활성 셀(병합 셀의 좌측 상단 셀)의 영역과 병합 정보를 오버레이한 디버그용 이미지를 생성합니다.  
&emsp;핵심 내용:  
&emsp;&emsp;원본 이미지 위에 각 활성 셀의 경계에 빨간 사각형을 그리고, 해당 셀의 병합 정보(예: "2x1" 등)를 텍스트로 표기합니다.  
&emsp;&emsp;생성된 디버그 이미지는 파일로 저장되어, 후속 검토나 디버깅에 활용됩니다.  
  
전체 파이프라인 요약  
  
&emsp;PDF → 이미지 변환: PDF를 고해상도 이미지로 변환하고 "images" 디렉토리에 저장합니다.  
&emsp;표 영역 추출 및 좌표 확보: 이미지 전처리 및 컨투어 검출을 통해 표 영역을 추출하고, 표 내부 셀 경계를 나타내는 x좌표와 y좌표 리스트를 확보합니다.  
&emsp;그리드 및 병합 셀 구성: 확보한 좌표 리스트를 사용해 기본 그리드를 생성하고, 경계선 감지 함수를 활용해 "현재 셀부터" 시작하여 우측 및 아래쪽으로 인접 셀의 병합 여부를 결정, 병합된 셀은 좌측 상단 셀에 병합 정보를 저장합니다.  
&emsp;디버그 이미지 생성: 생성된 셀 행렬을 원본 이미지 위에 오버레이하여, 각 셀의 경계와 병합 정보를 시각적으로 확인할 수 있도록 디버그 이미지를 생성하고 저장합니다.  
  
이와 같이, PDF 이미지 추출부터 표 영역(행렬) 구성 및 병합 셀 판별, 그리고 디버그 이미지 생성까지 전체 파이프라인이 구성되어 있습니다.  
각 단계는 대상 표의 특성에 맞게 전처리 방법이나 파라미터를 조정하여 사용합니다.  
